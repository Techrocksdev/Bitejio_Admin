import{R as k,r as n,j as e,L as _,b as A}from"./index-CPgWH55U.js";import{S as E,H as I}from"./header-C2h7oIiy.js";import{u as M,S as g}from"./skeleton-XVcMgJJP.js";import{u as F,F as z,b as L,c as P,s as j,d as U,e as D,g as R}from"./index-C_EH2wSA.js";function $({details:l,setDetails:t,refetch:o,setCurrentPage:h}){const{register:N,handleSubmit:f,formState:{errors:x},reset:p,setValue:b}=F({mode:"onChange"}),[u,y]=n.useState(!1),[c,r]=n.useState(null),[i,m]=n.useState(!1);n.useEffect(()=>{l?.name_en?(b("name_en",l?.name_en),b("status",l?.status),r(l?.image)):(p(),r(null),m(!1))},[l]);const v=async a=>{if(!c?.name){alert.show("Please upload a file");return}y(!0);const s=new FormData;s.append("images",c),Object.keys(a).forEach(d=>{s.append(d,a[d])});try{const d=l?.name_en?await L(l._id,s):await P(s);d.error?j(d.message,"error"):(j(d.message,"success"),h(1),await o(),document.getElementById("closeAddMerchantModal").click())}catch{console.log("An error occurred")}finally{y(!1)}},C=a=>{const s=a.target.files[0];r(s),l?.name_en?m(!0):m(!1)};return console.log(c,i,l?.name_en),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title text-main fw-bold",children:[l?.name_en?"Edit":"Add"," Category"]}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeAddMerchantModal",onClick:()=>{p(),t({}),r(null),m(!1)}})]}),e.jsxs("form",{onSubmit:f(v),children:[e.jsxs("div",{className:"modal-body row g-3",children:[e.jsxs("div",{className:"mb-3",children:[c?.name||c?e.jsxs("div",{className:"img-wrap position-relative",children:[e.jsx("img",{src:l.name_en&&c&&i?URL.createObjectURL(c):l.name_en&&c&&!i?c:URL.createObjectURL(c),alt:"Uploaded Image"}),e.jsx("i",{className:"fas fa-remove",onClick:()=>r(null)})]}):e.jsx("label",{htmlFor:"photo-upload",className:"custom-file-upload",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt"}),e.jsx("br",{}),"Upload Image"]})}),e.jsx("input",{className:"d-none",id:"photo-upload",type:"file",accept:"image/*",onChange:a=>C(a)})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Category Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${x.name_en?"input-error":""}`,placeholder:"Enter category name",...N("name_en",{required:"Category name is required"})}),x.name_en&&e.jsx("p",{className:"form-error",children:x.name_en.message})]}),e.jsxs("div",{className:"col-md-6 d-flex align-items-center",children:[e.jsx("label",{className:"form-label fw-semibold me-3",children:"Status"}),e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:l?.name_en?"":!0,...N("status")})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"submit",className:"btn comman-btn-main",disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"me-2",children:"Saving..."}),e.jsx(z,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):l?.name_en?"Edit":"Save"})})]})]})})}const B=k.memo($);function q({type:l}){const[t,o]=n.useState(1),[h,N]=n.useState(10),[f,x]=n.useState({}),[p,b]=n.useState("");n.useEffect(()=>{},[f]);const{data:u,isLoading:y,refetch:c}=M({queryKey:["categoryList",t,h,l],queryFn:async()=>R({page:t,pageSize:h,categoryId:"",allSubcategory:l==="Subcategory",search:""}),onError:a=>{console.log(a)}}),r=u?.results?.categories||[],i=Math.ceil(u?.results?.totalPages),m=a=>{a>0&&a<=i&&o(a)},v=async a=>{try{const s=await U(a);s.error?j(s.message,"error"):(j(s.message,"success"),c())}catch{console.log("An error occurred")}},C=async a=>{try{const s=await D(a);s.error?j(s.message,"error"):(j(s.message,"success"),document.getElementById("close").click(),c())}catch{console.log("An error occurred")}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end align-items-center mb-3",children:e.jsxs("button",{className:"btn btn-sm bg-main text-white","data-bs-toggle":"modal","data-bs-target":"#addCategoryModal",children:[e.jsx("i",{className:"fa fa-plus"})," Add Category"]})}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.No"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Category Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:y?[...Array(h)].map((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(g,{})}),e.jsx("td",{children:e.jsx(g,{})}),e.jsx("td",{children:e.jsx(g,{})}),e.jsx("td",{children:e.jsx(g,{})}),e.jsx("td",{children:e.jsx(g,{})})]},s)):r?.length?r?.map((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:s+1}),e.jsx("td",{children:e.jsx("div",{className:"table-img",children:e.jsx("img",{src:a.image,alt:a.image})})}),e.jsx("td",{children:a.name_en}),e.jsx("td",{children:e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:a.status,onChange:()=>v(a._id)})})}),e.jsxs("td",{className:"text-center",children:[e.jsx("button",{className:"table-btn bg-main me-2","data-bs-toggle":"modal","data-bs-target":"#addCategoryModal",onClick:()=>x(a),children:e.jsx("i",{className:"fa fa-edit"})}),e.jsx("button",{className:"table-btn bg-danger","data-bs-toggle":"modal","data-bs-target":"#delete",onClick:d=>{d.stopPropagation(),b(a._id)},children:e.jsx("i",{className:"fa fa-trash"})})]})]})):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"Oops! No Result Found."})})})]})}),r?.length?e.jsx("div",{className:"col-md-12 mt-3",children:e.jsxs("div",{className:"row align-items-center justify-content-between",children:[e.jsx("div",{className:"col-auto",children:e.jsxs("div",{className:"datafilter",children:[e.jsx("span",{children:"Showing"}),e.jsxs("select",{className:"form-select","aria-label":"Default select example",value:h,onChange:a=>{N(parseInt(a.target.value,10)),o(1)},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:20,children:"20"})]})]})}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"page_txt"})}),e.jsx("div",{className:"col-auto",children:e.jsx("nav",{"aria-label":"Page navigation example",children:e.jsxs("ul",{className:"pagination border-0 gap-2",children:[e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${t===1?"disabled":""}`,onClick:()=>m(t-1),disabled:t===1,children:e.jsx("i",{class:"fa fa-angle-left"})})}),Array.from({length:i}).map((a,s)=>s+1).filter(a=>a===1||a===i||Math.abs(a-t)<=2).reduce((a,s,d,w)=>(d>0&&s-w[d-1]>1&&a.push("..."),a.push(s),a),[]).map((a,s)=>a==="..."?e.jsx("span",{className:"pagination-ellipsis",children:"..."},s):e.jsx(e.Fragment,{children:e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${t===a?"active":""}`,onClick:()=>m(a),children:a},s)})})),e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${t===i?"disabled":""}`,onClick:()=>m(t+1),disabled:t===i,children:e.jsx("i",{class:"fa fa-angle-right"})})})]})})})]})}):"",e.jsx("div",{className:"modal fade",id:"addCategoryModal",tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:e.jsx(B,{details:f,setDetails:x,refetch:c,setCurrentPage:o})})}),e.jsx("div",{className:"modal fade logoutmodal",id:"delete",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsx("div",{className:"modal-content",children:e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"paymentmodal_main text-center",children:[e.jsxs("div",{className:"payment_head mb-3 mt-1",children:[e.jsx("h2",{children:"Confirmation"}),e.jsx("p",{children:"Are you sure you want to delete this category?"})]}),e.jsxs("div",{className:"row justify-content-center mb-2",children:[e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"comman-btn-main",onClick:()=>C(p),children:"Yes"})}),e.jsx("div",{className:"col-auto",children:e.jsx(_,{className:"comman-btn-main white","data-bs-dismiss":"modal",to:"",onClick:()=>b(""),id:"close",children:"No"})})]})]})})})})})]})}const S=k.memo(q);function O(){const{isSidebarHidden:l}=A(),[t,o]=n.useState("Category");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"admin-wrapper d-flex",children:[e.jsx(E,{}),e.jsxs("div",{className:l?"main-content flex-grow-1 full":"main-content flex-grow-1",id:"main-content",children:[e.jsx(I,{}),e.jsx("main",{className:"p-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"fw-semibold text-white fs-5",children:"Category Management"})}),e.jsxs("div",{className:"card-body tab-content",children:[e.jsxs("ul",{className:"nav nav-tabs card-header-tabs",id:"categoryTabs",role:"tablist",children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link active",id:"category-tab","data-bs-toggle":"tab",href:"#category",role:"tab",onClick:()=>o("Category"),children:"Category"})}),e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link",id:"subcategory-tab","data-bs-toggle":"tab",href:"#subcategory",role:"tab",onClick:()=>o("Subcategory"),children:"Subcategory"})})]}),e.jsx("div",{className:"tab-pane fade show active",id:"category",role:"tabpanel",children:e.jsx(S,{type:t})}),e.jsx("div",{className:"tab-pane fade",id:"subcategory",role:"tabpanel",children:e.jsx(S,{type:t})})]})]})})]})]}),e.jsx("div",{className:"modal fade",id:"addCategoryModal",tabIndex:-1,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Add Category"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Category Name"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter category name"})]}),e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:!0}),e.jsx("label",{className:"form-check-label",children:"Active"})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main",children:"Save"})})]})})}),e.jsx("div",{className:"modal fade",id:"editCategoryModal",tabIndex:-1,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Edit Category"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Category Name"}),e.jsx("input",{type:"text",className:"form-control",defaultValue:"Pizza"})]}),e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:!0}),e.jsx("label",{className:"form-check-label",children:"Active"})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main",children:"Update"})})]})})}),e.jsx("div",{className:"modal fade",id:"addSubcategoryModal",tabIndex:-1,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Add Subcategory"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Select Category"}),e.jsxs("select",{className:"form-select",children:[e.jsx("option",{children:"Pizza"}),e.jsx("option",{children:"Burger"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Subcategory Name"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter subcategory name"})]}),e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:!0}),e.jsx("label",{className:"form-check-label",children:"Active"})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main",children:"Save"})})]})})}),e.jsx("div",{className:"modal fade",id:"editSubcategoryModal",tabIndex:-1,children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Edit Subcategory"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Select Category"}),e.jsxs("select",{className:"form-select",children:[e.jsx("option",{selected:!0,children:"Pizza"}),e.jsx("option",{children:"Burger"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Subcategory Name"}),e.jsx("input",{type:"text",className:"form-control",defaultValue:"Veg Pizza"})]}),e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:!0}),e.jsx("label",{className:"form-check-label",children:"Active"})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main",children:"Update"})})]})})})]})}const K=k.memo(O);export{K as default};
