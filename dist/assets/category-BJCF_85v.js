import{R as w,r as i,j as e,s as g,h as I,i as F,e as E,k as L,L as A,l as D,m as R,a as q}from"./index-CgaEN1a8.js";import{S as $,H as O}from"./header-DroCE59z.js";import{S as j}from"./skeleton-BhXmMjDi.js";import{u as M,F as U}from"./index-DsWZgHVr.js";function P({details:s,setDetails:r,refetch:h,setCurrentPage:b}){const{register:S,handleSubmit:f,formState:{errors:u},reset:x,setValue:p}=M({mode:"onChange"}),[N,v]=i.useState(!1),[n,l]=i.useState(null),[c,m]=i.useState(!1);i.useEffect(()=>{s?.name_en?(p("name_en",s?.name_en),p("status",s?.status),l(s?.image)):(x(),l(null),m(!1))},[s]);const y=async a=>{if(console.log(n),!n?.name&&!n){g("Please upload a file","error");return}v(!0);const t=new FormData;t.append("images",s.name_en&&n&&!c?[]:n),Object.keys(a).forEach(o=>{t.append(o,a[o])});try{const o=s?.name_en?await I(s._id,t):await F(t);o.error?g(o.message,"error"):(g(o.message,"success"),b(1),await h(),document.getElementById("closeAddMerchantModal").click())}catch{console.log("An error occurred")}finally{v(!1)}},k=a=>{const t=a.target.files[0];l(t),s?.name_en?m(!0):m(!1)};return console.log(n,c,s?.name_en),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title text-main fw-bold",children:[s?.name_en?"Edit":"Add"," Category"]}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeAddMerchantModal",onClick:()=>{x(),r({}),l(null),m(!1)}})]}),e.jsxs("form",{onSubmit:f(y),children:[e.jsxs("div",{className:"modal-body row g-3",children:[e.jsxs("div",{className:"mb-3",children:[n?.name||n?e.jsxs("div",{className:"img-wrap position-relative",children:[e.jsx("img",{src:s.name_en&&n&&c?URL.createObjectURL(n):s.name_en&&n&&!c?n:URL.createObjectURL(n),alt:"Uploaded Image"}),e.jsx("i",{className:"fas fa-remove",onClick:()=>l(null)})]}):e.jsx("label",{htmlFor:"photo-upload",className:"custom-file-upload",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt"}),e.jsx("br",{}),"Upload Image"]})}),e.jsx("input",{className:"d-none",id:"photo-upload",type:"file",accept:"image/*",onChange:a=>k(a)})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Category Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${u.name_en?"input-error":""}`,placeholder:"Enter category name",...S("name_en",{required:"Category name is required"})}),u.name_en&&e.jsx("p",{className:"form-error",children:u.name_en.message})]}),e.jsxs("div",{className:"col-md-6 d-flex align-items-center",children:[e.jsx("label",{className:"form-label fw-semibold me-3",children:"Status"}),e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:s?.name_en?"":!0,...S("status")})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"submit",className:"btn comman-btn-main",disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"me-2",children:"Saving..."}),e.jsx(U,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):s?.name_en?"Edit":"Save"})})]})]})})}const B=w.memo(P);function z({details:s,setDetails:r,refetch:h,setCurrentPage:b,type:S}){const{register:f,handleSubmit:u,formState:{errors:x},reset:p,setValue:N}=M({mode:"onChange"}),[v,n]=i.useState(!1),[l,c]=i.useState(null),[m,y]=i.useState(!1);i.useEffect(()=>{s?.name_en?(N("name_en",s?.name_en),N("status",s?.status),N("parentCategoryId",s?.parentCategory?._id),c(s?.image)):(p(),c(null),y(!1))},[s]);const k=async d=>{if(!l?.name&&!l){g("Please upload a file","error");return}n(!0);const _=new FormData;_.append("images",s.name_en&&l&&!m?[]:l),Object.keys(d).forEach(C=>{_.append(C,d[C])});try{const C=s?.name_en?await I(s._id,_):await F(_);C.error?g(C.message,"error"):(g(C.message,"success"),b(1),await h(),document.getElementById("closeAddMerchantModal").click())}catch{console.log("An error occurred")}finally{n(!1)}},a=d=>{const _=d.target.files[0];c(_),s?.name_en?y(!0):y(!1)},{data:t}=E({queryKey:["selectCategoryList",S],queryFn:async()=>L({page:1,pageSize:1e3,categoryId:"",allSubcategory:!1,search:""}),onError:d=>{console.log(d)}}),o=t?.results?.categories||[];return console.log(l,m,s?.name_en),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title text-main fw-bold",children:[s?.name_en?"Edit":"Add"," Category"]}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeAddMerchantModal",onClick:()=>{p(),r({}),c(null),y(!1)}})]}),e.jsxs("form",{onSubmit:u(k),children:[e.jsxs("div",{className:"modal-body row g-3",children:[e.jsxs("div",{className:"mb-3",children:[l?.name||l?e.jsxs("div",{className:"img-wrap position-relative",children:[e.jsx("img",{src:s.name_en&&l&&m?URL.createObjectURL(l):s.name_en&&l&&!m?l:URL.createObjectURL(l),alt:"Uploaded Image"}),e.jsx("i",{className:"fas fa-remove",onClick:()=>c(null)})]}):e.jsx("label",{htmlFor:"photo-upload",className:"custom-file-upload",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-cloud-upload-alt"}),e.jsx("br",{}),"Upload Image"]})}),e.jsx("input",{className:"d-none",id:"photo-upload",type:"file",accept:"image/*",onChange:d=>a(d)})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Select Category"}),e.jsxs("select",{className:`form-control form-select ${x.parentCategoryId?"input-error":""}`,...f("parentCategoryId",{required:"Category name is required"}),children:[e.jsx("option",{hidden:!0,children:"Select Category"}),o.map(d=>e.jsx("option",{value:d._id,children:d.name_en},d._id))]}),x.parentCategoryId&&e.jsx("p",{className:"form-error",children:x.parentCategoryId.message})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Sub Category Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${x.name_en?"input-error":""}`,placeholder:"Enter sub category name",...f("name_en",{required:"Sub Category name is required"})}),x.name_en&&e.jsx("p",{className:"form-error",children:x.name_en.message})]}),e.jsxs("div",{className:"col-md-6 d-flex align-items-center",children:[e.jsx("label",{className:"form-label fw-semibold me-3",children:"Status"}),e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:s?.name_en?"":!0,...f("status")})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"submit",className:"btn comman-btn-main",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"me-2",children:"Saving..."}),e.jsx(U,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):s?.name_en?"Edit":"Save"})})]})]})})}const H=w.memo(z);function K({type:s}){const[r,h]=i.useState(1),[b,S]=i.useState(10),[f,u]=i.useState({}),[x,p]=i.useState("");i.useEffect(()=>{},[f]);const{data:N,isLoading:v,refetch:n}=E({queryKey:["categoryList",r,b,s],queryFn:async()=>L({page:r,pageSize:b,categoryId:"",allSubcategory:s==="Subcategory",search:""}),onError:a=>{console.log(a)}}),l=N?.results?.categories||[],c=Math.ceil(N?.results?.totalPages),m=a=>{a>0&&a<=c&&h(a)},y=async a=>{try{const t=await D(a);t.error?g(t.message,"error"):(g(t.message,"success"),n())}catch{console.log("An error occurred")}},k=async a=>{try{const t=await R(a);t.error?g(t.message,"error"):(g(t.message,"success"),document.getElementById("close").click(),n())}catch{console.log("An error occurred")}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end align-items-center mb-3",children:e.jsxs("button",{className:"btn btn-sm bg-main text-white","data-bs-toggle":"modal","data-bs-target":"#addCategoryModal",children:[e.jsx("i",{className:"fa fa-plus"})," ",s==="Subcategory"?"Add Sub Category":"Add Category"]})}),e.jsx("div",{className:"table-responsive",children:s==="Subcategory"?e.jsxs("table",{className:"table table-hover align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.No"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Category Name"}),e.jsx("th",{children:"Sub Category Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:v?[...Array(b)].map((a,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})})]},t)):l?.length?l?.map((a,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx("div",{className:"table-img",children:e.jsx("img",{src:a.image,alt:a.image})})}),e.jsx("td",{children:a?.parentCategory?.name_en}),e.jsx("td",{children:a.name_en}),e.jsx("td",{children:e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:a.status,onChange:()=>y(a._id)})})}),e.jsxs("td",{className:"text-center",children:[e.jsx("button",{className:"table-btn bg-main me-2","data-bs-toggle":"modal","data-bs-target":"#addCategoryModal",onClick:()=>u(a),children:e.jsx("i",{className:"fa fa-edit"})}),e.jsx("button",{className:"table-btn bg-danger","data-bs-toggle":"modal","data-bs-target":"#delete",onClick:o=>{o.stopPropagation(),p(a._id)},children:e.jsx("i",{className:"fa fa-trash"})})]})]})):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center",children:"Oops! No Result Found."})})})]}):e.jsxs("table",{className:"table table-hover align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.No"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Category Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:v?[...Array(b)].map((a,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})})]},t)):l?.length?l?.map((a,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx("div",{className:"table-img",children:e.jsx("img",{src:a.image,alt:a.image})})}),e.jsx("td",{children:a.name_en}),e.jsx("td",{children:e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:a.status,onChange:()=>y(a._id)})})}),e.jsxs("td",{className:"text-center",children:[e.jsx("button",{className:"table-btn bg-main me-2","data-bs-toggle":"modal","data-bs-target":"#addCategoryModal",onClick:()=>u(a),children:e.jsx("i",{className:"fa fa-edit"})}),e.jsx("button",{className:"table-btn bg-danger","data-bs-toggle":"modal","data-bs-target":"#delete",onClick:o=>{o.stopPropagation(),p(a._id)},children:e.jsx("i",{className:"fa fa-trash"})})]})]})):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"Oops! No Result Found."})})})]})}),l?.length?e.jsx("div",{className:"col-md-12 mt-3",children:e.jsxs("div",{className:"row align-items-center justify-content-between",children:[e.jsx("div",{className:"col-auto",children:e.jsxs("div",{className:"datafilter",children:[e.jsx("span",{children:"Showing"}),e.jsxs("select",{className:"form-select","aria-label":"Default select example",value:b,onChange:a=>{S(parseInt(a.target.value,10)),h(1)},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:20,children:"20"})]})]})}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"page_txt"})}),e.jsx("div",{className:"col-auto",children:e.jsx("nav",{"aria-label":"Page navigation example",children:e.jsxs("ul",{className:"pagination border-0 gap-2",children:[e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${r===1?"disabled":""}`,onClick:()=>m(r-1),disabled:r===1,children:e.jsx("i",{class:"fa fa-angle-left"})})}),Array.from({length:c}).map((a,t)=>t+1).filter(a=>a===1||a===c||Math.abs(a-r)<=2).reduce((a,t,o,d)=>(o>0&&t-d[o-1]>1&&a.push("..."),a.push(t),a),[]).map((a,t)=>a==="..."?e.jsx("span",{className:"pagination-ellipsis",children:"..."},t):e.jsx(e.Fragment,{children:e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${r===a?"active":""}`,onClick:()=>m(a),children:a},t)})})),e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${r===c?"disabled":""}`,onClick:()=>m(r+1),disabled:r===c,children:e.jsx("i",{class:"fa fa-angle-right"})})})]})})})]})}):"",e.jsx("div",{className:"modal fade",id:"addCategoryModal",tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:s==="Subcategory"?e.jsx(H,{details:f,setDetails:u,refetch:n,setCurrentPage:h,type:s}):e.jsx(B,{details:f,setDetails:u,refetch:n,setCurrentPage:h})})}),e.jsx("div",{className:"modal fade logoutmodal",id:"delete",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsx("div",{className:"modal-content",children:e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"paymentmodal_main text-center",children:[e.jsxs("div",{className:"payment_head mb-3 mt-1",children:[e.jsx("h2",{children:"Confirmation"}),e.jsx("p",{children:"Are you sure you want to delete this category?"})]}),e.jsxs("div",{className:"row justify-content-center mb-2",children:[e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"comman-btn-main",onClick:()=>k(x),children:"Yes"})}),e.jsx("div",{className:"col-auto",children:e.jsx(A,{className:"comman-btn-main white","data-bs-dismiss":"modal",to:"",onClick:()=>p(""),id:"close",children:"No"})})]})]})})})})})]})}const V=w.memo(K);function W(){const{isSidebarHidden:s}=q(),[r,h]=i.useState("Category");return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"admin-wrapper d-flex",children:[e.jsx($,{}),e.jsxs("div",{className:s?"main-content flex-grow-1 full":"main-content flex-grow-1",id:"main-content",children:[e.jsx(O,{}),e.jsx("main",{className:"p-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"fw-semibold text-white fs-5",children:"Category Management"})}),e.jsxs("div",{className:"card-body tab-content",children:[e.jsxs("ul",{className:"nav nav-tabs card-header-tabs",children:[e.jsx("li",{className:"nav-item",children:e.jsx(A,{className:r==="Category"?"nav-link active":"nav-link",to:"",onClick:()=>h("Category"),children:"Category"})}),e.jsx("li",{className:"nav-item",children:e.jsx(A,{className:r==="Subcategory"?"nav-link active":"nav-link",to:"",onClick:()=>h("Subcategory"),children:"Subcategory"})})]}),e.jsx("div",{className:"tab-pane fade show active",children:e.jsx(V,{type:r})})]})]})})]})]})})}const J=w.memo(W);export{J as default};
